[![Build Status](https://travis-ci.org/scoverage/gradle-scoverage.png?branch=master)](https://travis-ci.org/scoverage/gradle-scoverage)

gradle-scoverage
================
A plugin to enable the use of Scoverage in a gradle Scala project.

Getting started
---------------
http://plugins.gradle.org/plugin/org.scoverage

This creates an additional task `testScoverage` which will run tests against instrumented code.

A further task `reportScoverage` produces XML and HTML reports for analysing test code coverage.

You can configure the version of Scoverage that will be used. This plugin should be compatible with all 1+ versions.

```groovy
scoverage {
    scoverageVersion = "1.3.1"
    scoverageScalaVersion = "2.12" // will be overridden by the 'scala-library' version (if configured)
}
```

Then launch command :
`gradle reportScoverage` or `gradle checkScoverage`

Available tasks
---------------

* testScoverage - Executes all tests and creates Scoverage XML report with information about code coverage
* reportScoverage - Generates reports (see below).
* aggregateScoverage - Aggregates reports from multiple sub-projects (see below).
* checkScoverage - See below.
* compileScoverageScala - Instruments code without running tests.

ReportScoverage
---------------

You can configure output generated by `gradle reportScoverage` using flags:

| Flag name               | Default value | Description                                     |
| ------------------------|---------------|-------------------------------------------------|
| coverageOutputCobertura | true          | Enables/disables cobertura.xml file generation. |
| coverageOutputXML       | true          | Enables/disables scoverage XML output.          |
| coverageOutputHTML      | true          | Enables/disables scoverage HTML output.         |
| coverageDebug           | false         | Enables/disables scoverage debug output.        |

Aggregating Reports
-------------------


There is now experimental support for aggregating coverage statistics in composite builds.

When applied on a project with sub-projects, the plugin will create the aggregation task `aggregateScoverage`, which
will first generate reports for each project individually (including the parent project), and will then generate an
aggregated result based on these reports.

The aggregated report will override the parent-project specific report (`parent-project/build/reports/scoverage`).

One can still use `reportScoverage` in order to generate a report without aggregation.

Aggregation uses same flags as reporting for enabling/disabling different output types.

CheckScoverage
--------------

The `checkScoverage` task validates coverage status according the generated reports.

`gradle checkScoverage` will automatically generate reports via `reportScoverage` but it won't generate aggregated reports.
In order to check coverage of aggregated reports one should use `gradle checkScoverage aggregateScoverage`.

By default, when you launch `gradle checkScoverage` build fail if only 75% of statements in project is covered by tests.

To configure it as you want, add this configuration :
```
checkScoverage {
    minimumRate = 0.5
}
```

You can also modify type of value to check from `Statement`s to `Line`s or `Branch`es:

```
checkScoverage {
    coverageType = 'Line'
    minimumRate = 0.5
}
```

```
checkScoverage {
    coverageType = 'Branch'
    minimumRate = 0.5
}
```
